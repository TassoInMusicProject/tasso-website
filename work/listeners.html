<script>
// vim: ts=3

//////////////////////////////
//
// DOMContentLoaded event listener --
//

document.addEventListener("DOMContentLoaded", function() {
	vrvToolkit = new verovio.toolkit();
	HighlightNavigationBar();
	var cgi = GetCgiParameters();
	if (cgi.k) {
		setupVariables(cgi.k);
	}
	ID = cgi.id;
	loadWorkList("{{site.worklist}}");
	CheckLocalStorage();
});



//////////////////////////////
//
// keydown event listener --
//

window.addEventListener('keydown',
	function(event) {
		if (event.metaKey) {
			return;
		}

		switch (event.keyCode) {

			case ZeroKey:  showPart(0); break;
			case OneKey:   showPart(1); break;
			case TwoKey:   showPart(2); break;
			case ThreeKey: showPart(3); break;
			case FourKey:  showPart(4); break;
			case FiveKey:  showPart(5); break;
			case SixKey:   showPart(6); break;
			case SevenKey: showPart(7); break;
			case EightKey: showPart(8); break;
			case NineKey:  showPart(9); break;

			case EKey:
				if (event.altKey) {
					toggleExpertMode();
				} else {
				expandIncipit();
				}
				break;

			case OKey:
				ORIGINAL_CLEFS = !ORIGINAL_CLEFS;
				initializeVerovioNotation();
				break;

			case TKey:
				INCLUDE_TEXT = !INCLUDE_TEXT;
				initializeVerovioNotation();
				break;

			case LeftArrowKey:
				displayPreviousWork();
				event.preventDefault();
				break;

			case RightArrowKey:
				displayNextWork();
				event.preventDefault();
				break;

			case UpArrowKey:
				if (event.shiftKey) {
					displayWorkList();
					event.preventDefault();
				}
				break;
		}
	}
);

</script>

